package aoc

import org.junit.Test
import kotlin.test.assertEquals

class Day20Test {

    private val problemInput = """
                                               G F         Z   T     Y   C         Y                                 
                                               E Z         Z   Q     I   T         X                                 
              #################################.#.#########.###.#####.###.#########.###############################  
              #...#.................#...#...#...#.....#...#.....#.....#.#.#.#...#.#...#...#.#.#.#.#...#.#.....#.#.#  
              #.#############.#.###.#.###.#####.###.#####.#####.#.#####.#.#.#.###.#.#.#.###.#.#.#.#.#.#.###.###.#.#  
              #.#.#.#...#.....#.#.........#.#...#.....#.#.......#.......#.......#...#.#...#.......#.#.#.#.#...#...#  
              #.#.#.#.#######.#######.###.#.#.#.###.###.#.###.#########.###.#.#####.###.###.#########.#.#.#.#####.#  
              #...#...#.#...#.#.......#.......#.#.#.#.#.....#.#.........#...#.....#.........#.#.....#.#.#.........#  
              ###.###.#.#.#####.#.#######.#.###.#.#.#.###.#######.#####.#######.#####.#######.#.###.#.#.#.#########  
              #.........#.#...#.#...#.#...#.#.#.#.#.....#.....#.#.....#...#...#...#...........#.#.#.#...#.........#  
              #########.#.###.#######.#######.#.#.###.#######.#.#.#.###.#####.#.###.#########.###.#.#.###.#######.#  
              #...#.#.#.........#.......#.#...#.#...#...#.......#.#...#.....#.....#...#.....#...#.#.#...#...#...#.#  
              #.###.#.#.###.#######.###.#.###.#.#.#.#.###.###.#####.###.#.#####.###.#.#.#########.#.#.###.###.#####  
              #.....#.....#.#.#.#.#...#...#.....#.#.....#.#.#.#.#...#...#.#.....#.#.#.......#.......#.....#...#...#  
              ###.###.#######.#.#.#####.#.#####.#.#######.#.###.#.#.###.#.#####.#.###.#.###.###.#.#.#.#######.#.###  
              #.....#.....#.......#...#.#.#.....#.....#...#.....#.#...#.#.#...#.....#.#...#.#.#.#.#.#.#.....#.#...#  
              #.#.#.#.###########.###.###.#####.#.#######.###.###.###.#####.###.#.###.###.###.#.#####.#.#####.#.###  
              #.#.#.......#.#.........#.#.#.#.#.#.#.#.....#.....#...#.#.........#.#.....#...#...#.#...#.#...#...#.#  
              #.#####.#####.#####.#.#.#.#.#.#.#.#.#.#####.###.###.###########.#######.#.#.#.###.#.###.#.###.#.#.#.#  
              #.#.#.#...#.#...#.#.#.#.....#.#.#.#...#.....#.#...#...#.#.#.......#.#.#.#.#.#.#.#.....#.....#...#.#.#  
              ###.#.#.###.#.###.###.#.###.#.#.#.#.#.#.###.#.#.###.###.#.#####.#.#.#.#.#######.#.#####.#######.###.#  
              #.....#.....#.#.....#.#.#.......#.#.#.#.#.#.......#.#.....#.....#.#...#...........#...........#.#...#  
              ###.#.#.#.###.#####.#######.###.#.#.#####.#.#####.#.#.#####.#.#.###.#.#.###.#.#########.#.#####.#.#.#  
              #.#.#.#.#.#.#.....#.....#.....#...#.......#.#.....#.#.....#.#.#.#.#.#.....#.#.#.....#...#...#...#.#.#  
              #.###.#.###.###.###.#.#.#####.#.#.#.#####.###.#####.###.#######.#.#.#.#.###########.###.#####.#.#.###  
              #.#.........#.#.#.#.#.#.#.....#.#.#.#.....#.......#.......#.......#.#.#.......#.#.#.#.#...#...#.#...#  
              #.#####.#.###.#.#.#.###.#####.#######.#########.#######.#########.#.###########.#.#.#.###.#####.#.###  
              #...#...#...#.....#.#.#.#    L       K         T       O         G V        #.#.#.#.....#...#.#.....#  
              ###.###.#########.###.#.#    I       L         X       K         E Y        #.#.#.#.#####.###.#.#####  
              #.........#...#.........#                                                   #.............#...#.#...#  
              ###.#.#######.###.#.#.#.#                                                   #.###.#.#.#.#.#.#.#.#.###  
            NA..#.#.#...#.#...#.#.#.#..ZV                                                 #...#.#.#.#.#...#.....#.#  
              #.#.#.#.###.#.#.#.#.#.###                                                   ###.#.#####.#######.###.#  
              #.#.#.#.....#.#.#.#.#...#                                                   #...#.#...#...#...#.#.#..EH
              #.#.#.#.#.###.#########.#                                                   #.#.###.###.###.###.#.#.#  
              #...#...#...............#                                                 PB..#.#.#...#.#...#.#.....#  
              ###.#.#####.#####.#######                                                   #####.#.#######.#.#.#####  
              #...#.#.....#.....#.....#                                                 YX..........#.#...#.#.#.#.#  
              ###.#########.#.#.#.###.#                                                   #.#.###.###.#.#.#.###.#.#  
              #.......#.#...#.#.#...#.#                                                   #.#.#.#.......#...#...#.#  
              #.#######.#########.###.#                                                   #####.#.#####.###.#.###.#  
              #.#.#.#.#...........#....HM                                                 #.#...#...#.#.#.......#..KL
              ###.#.#.#.###.#####.###.#                                                   #.###.#####.#.#####.###.#  
            ZV..........#.....#.#...#.#                                                   #.#.#...#...#...#.#.....#  
              #############.#.#.#.###.#                                                   #.#.#.###.#######.#####.#  
            YB..........#...#...#.#...#                                                   #.....#.....#...#...#...#  
              ###.###.#######.#########                                                   #.###.###.#.#.###.#.#####  
              #...#.....#.....#.#...#.#                                                 HP....#...#.#.......#.#....XC
              #.#.#####.#######.###.#.#                                                   #.###.#.#.###.#.###.#.###  
              #.#.#.#.........#.#.#.#..TQ                                                 #.#.#.#...#...#.#.....#.#  
              #####.#####.#.###.#.#.#.#                                                   ###.###################.#  
              #.#.......#.#...........#                                                   #.#.....................#  
              #.#####.#################                                                   #.#.###.#.###.###.###.###  
              #.#......................GY                                               QD..#...#.#...#...#.#...#.#  
              #.###.#.#.#####.###.###.#                                                   #.###.#.#.###.###.#.#.#.#  
              #.....#.#.#.......#...#.#                                                   #.#...#.#.#...#...#.#.#..VY
              ###.###########.###.#.###                                                   #.#.#.#######.#######.#.#  
              #.#...........#...#.#...#                                                   #...#.....#.....#.......#  
              #.###.#.###########.###.#                                                   #################.###.###  
            LA......#.#.....#.#.....#.#                                                   #.......#.#...#.#...#...#  
              #####.###.#.###.#########                                                   #.###.###.#.###.#########  
            PB....#...#.#.#.....#.#.#..YI                                               LA..#...#.#.....#...#.#.#..AA
              #.###.#.#.#####.###.#.#.#                                                   ###.###.#.#.###.###.#.#.#  
              #...#.#.#...#.....#.....#                                                   #.#.....#.#.#.....#.....#  
              #.#######.#####.###.###.#                                                   #.#.###.###.#.#.#####.#.#  
              #.#.....#.#.#.#...#...#.#                                                   #.#...#.......#.......#..QD
              #.#.#.###.#.#.#.###.###.#                                                   #.#######.#.#####.#.#####  
              #...#...............#.#.#                                                 UC..#.....#.#.#.#.#.#.#.#..XV
              #####.###############.###                                                   #.#.###.#####.#.###.#.#.#  
              #...#.#...........#.....#                                                   #.#...#...#.....#.#.#...#  
              #.#.###.#.#.#.#.#.###.###                                                   #.###.###.###.#.#.###.#.#  
            HP..#.....#.#.#.#.#........YB                                                 #.....#.......#.......#.#  
              #####.#.#####.#.#.#######                                                   ###########.#.#####.#.###  
            LI....#.#.....#.#.#.#......XC                                               XV........#...#.#.#.#.#.#.#  
              #.#####.#.#########.###.#                                                   #.#####.###.###.#.###.#.#  
              #...#.#.#.#.....#.#.#...#                                                   #.#.......#...#.#...#.#.#  
              #.###.#####.#.###.#.#####                                                   ###.#######.###.#.#####.#  
              #...#...#.#.#.....#.....#                                                   #...#...#.#.#.......#.#..HM
              ###.#.#.#.###.#.#######.#                                                   #.###.#.#.###.#.#####.#.#  
              #.....#.......#.........#                                                   #.....#.......#.........#  
              ###.#.###.###.#.#.###.#.#        N     E     F   C     X   T           T    ###.#####.#####.#.#####.#  
              #...#...#.#...#.#.#...#.#        A     H     Z   T     O   Y           N    #.......#...#...#.#.....#  
              #.###.#####.#####.#.#.###########.#####.#####.###.#####.###.###########.#####.#.#.#########.#######.#  
              #.#.....#...#.....#.#.#...........#.....#...#.....#.....#.........#.........#.#.#.....#.....#.#...#.#  
              #####.#####.###.#########.#.#######.#####.#.###.###.#######.#.#######.###.#####.#############.###.#.#  
              #.#.#...#.....#.#.......#.#.....#.#.......#.#.#.#.#.....#.#.#.#.....#.#.......#.......#.............#  
              #.#.#.###.###.#.#####.#####.#.###.#######.###.#.#.#####.#.###.###.###.###.#.#.#.#.#######.#.###.###.#  
              #.......#...#.#.#...........#.#.#...#...#...#.......#...#...#.....#.#.#.#.#.#.#.#...#.....#.#...#...#  
              ###.#####.###.#######.#.###.###.###.#.#.#.#####.#.#####.#.#####.###.###.#.###.#############.#######.#  
              #.#.#.......#.#...#...#.#.....#.#.....#...#.#...#.#...#...#.#.........#...#...#.#...#.#.#...#.#.....#  
              #.#.#.###.#####.#.###.#######.#.#.#.###.#.#.#####.###.###.#.###.###.#####.###.#.#.#.#.#.###.#.###.#.#  
              #...#.#...#.#...#.#.....#.......#.#.#.#.#.#.......#.#.......#...#...#.......#.#.#.#.#...........#.#.#  
              ###.###.#.#.#.###.###.#####.#######.#.###.#.#.###.#.###.#.#####.#######.#######.#.#########.#####.#.#  
              #.....#.#.#...#.......#.......#.......#.#.#.#...#...#.#.#.#...#...#.......................#.#.....#.#  
              ###.#################.#####.#######.###.#####.###.###.#.###.#####.#######.#.#####.#.###.###.#####.#.#  
              #.....#.#.....#.........#.#.....#...#.#.#.#.#.#.......#...#.....#.#.#.....#.#.#.#.#...#.#.....#...#.#  
              ###.#.#.###.#.#.#########.#####.###.#.#.#.#.###.###.#####.#.###.#.#.###.#####.#.#########.#.###.###.#  
              #.#.#.#.#.#.#...#.#.............#.#.#...#.........#.#...#.#.#.#...#...............#.#.#...#...#...#.#  
              #.#####.#.###.###.###.###.#.#.#.#.#.###.#########.###.###.#.#.###.#.###.###########.#.###.#####.#.###  
              #.....#.......#.......#...#.#.#.#.#.....#...#.#.....#.....#...#.#.#...#...#...........#.......#.#...#  
              #.###.###.#####.#.#.#####.#.###.#.#.#######.#.###.#####.#.#.#.#.###.#######.#######.#####.#####.#####  
              #.#...#.#.#.....#.#.#.....#.#...#...#.#...........#.....#.#.#.....#.#...#.........#.#.#.......#.....#  
              #####.#.#.###.#.#######.#.#.#######.#.#####.#####.#######.#.#.#####.#.#####.#########.###.#.###.###.#  
              #.........#.#.#...#...#.#.#.#.....#.......#.....#.#...#.#.#.#.#...#...#...#.#...#...#.....#.#...#...#  
              ###.#.#.#.#.#.#.###.#.#####.#####.#.###.#.#####.###.###.#.###.###.#.###.###.#.###.###.#.###.###.#.#.#  
              #...#.#.#.#...#.#...#...........#.....#.#.....#.......#.....#...#...................#.#.#...#...#.#.#  
              #############################.###########.#####.#.#######.###.###########.###########################  
                                           T           T     O T       U   G           X                             
                                           X           N     K Y       C   Y           O
        """.trimIndent()

    @Test
    fun sampleOne() {
        val input = """
             A           
             A           
      #######.#########  
      #######.........#  
      #######.#######.#  
      #######.#######.#  
      #######.#######.#  
      #####  B    ###.#  
    BC...##  C    ###.#  
      ##.##       ###.#  
      ##...DE  F  ###.#  
      #####    G  ###.#  
      #########.#####.#  
    DE..#######...###.#  
      #.#########.###.#  
    FG..#########.....#  
      ###########.#####  
                 Z       
                 Z       
        """.trimIndent()
        val parsed = parseDonutMaze(input)
        assertEquals(23, parsed.shortestPath())
    }

    @Test
    fun sampleTwo() {
        val input = """
                               A               
                               A               
              #################.#############  
              #.#...#...................#.#.#  
              #.#.#.###.###.###.#########.#.#  
              #.#.#.......#...#.....#.#.#...#  
              #.#########.###.#####.#.#.###.#  
              #.............#.#.....#.......#  
              ###.###########.###.#####.#.#.#  
              #.....#        A   C    #.#.#.#  
              #######        S   P    #####.#  
              #.#...#                 #......VT
              #.#.#.#                 #.#####  
              #...#.#               YN....#.#  
              #.###.#                 #####.#  
            DI....#.#                 #.....#  
              #####.#                 #.###.#  
            ZZ......#               QG....#..AS
              ###.###                 #######  
            JO..#.#.#                 #.....#  
              #.#.#.#                 ###.#.#  
              #...#..DI             BU....#..LF
              #####.#                 #.#####  
            YN......#               VT..#....QG
              #.###.#                 #.###.#  
              #.#...#                 #.....#  
              ###.###    J L     J    #.#.###  
              #.....#    O F     P    #.#...#  
              #.###.#####.#.#####.#####.###.#  
              #...#.#.#...#.....#.....#.#...#  
              #.#####.###.###.#.#.#########.#  
              #...#.#.....#...#.#.#.#.....#.#  
              #.###.#####.###.###.#.#.#######  
              #.#.........#...#.............#  
              #########.###.###.#############  
                       B   J   C               
                       U   P   P               
        """.trimIndent()
        println(input)
        val parsed = parseDonutMaze(input)
        assertEquals(58, parsed.shortestPath())
    }

    @Test
    fun partOne() {
        println(problemInput)
        val parsed = parseDonutMaze(problemInput)
        println(parsed.shortestPath())
    }

    @Test
    fun partTwoSample() {
        val input = """
                         Z L X W       C                 
                         Z P Q B       K                 
              ###########.#.#.#.#######.###############  
              #...#.......#.#.......#.#.......#.#.#...#  
              ###.#.#.#.#.#.#.#.###.#.#.#######.#.#.###  
              #.#...#.#.#...#.#.#...#...#...#.#.......#  
              #.###.#######.###.###.#.###.###.#.#######  
              #...#.......#.#...#...#.............#...#  
              #.#########.#######.#.#######.#######.###  
              #...#.#    F       R I       Z    #.#.#.#  
              #.###.#    D       E C       H    #.#.#.#  
              #.#...#                           #...#.#  
              #.###.#                           #.###.#  
              #.#....OA                       WB..#.#..ZH
              #.###.#                           #.#.#.#  
            CJ......#                           #.....#  
              #######                           #######  
              #.#....CK                         #......IC
              #.###.#                           #.###.#  
              #.....#                           #...#.#  
              ###.###                           #.#.#.#  
            XF....#.#                         RF..#.#.#  
              #####.#                           #######  
              #......CJ                       NM..#...#  
              ###.#.#                           #.###.#  
            RE....#.#                           #......RF
              ###.###        X   X       L      #.#.#.#  
              #.....#        F   Q       P      #.#.#.#  
              ###.###########.###.#######.#########.###  
              #.....#...#.....#.......#...#.....#.#...#  
              #####.#.###.#######.#######.###.###.#.#.#  
              #.......#.......#.#.#.#.#...#...#...#.#.#  
              #####.###.#####.#.#.#.#.###.###.#.###.###  
              #.......#.....#.#...#...............#...#  
              #############.#.#.###.###################  
                           A O F   N                     
                           A A D   M                     
        """.trimIndent()
        println(input)
        val parsed = parseDonutMaze(input, withRecursion = true)
        assertEquals(396, parsed.shortestPath())
    }

    @Test
    fun partTwo() {
        val parsed = parseDonutMaze(problemInput, withRecursion = true)
        println(parsed.shortestPath())
    }
}